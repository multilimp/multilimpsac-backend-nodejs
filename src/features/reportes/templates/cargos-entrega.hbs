<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporte de Cargos de Entrega</title>
    <style>
        {
                {
                    {
                    css
                }
            }
        }
    </style>
</head>

<body>
    <div class="contenedor">
        {{#if fechasConCargos}}
        <!-- Listado de cargos por fecha -->
        {{#each fechasConCargos}}
        <div class="fecha-seccion">
            <h2 class="fecha-titulo">Fecha de Programación: {{ this.fecha }}</h2>

            {{#each this.ops}}
            <div class="op-container">
                <!-- Encabezado de la OP -->
                <table class="op-header">
                    <tr>
                        <td class="op-numero">{{increment @index}}</td>
                        <td class="op-codigo">{{ this.codigoOp }}<br><span class="ocf-text">{{#if this.ocf}}OCF: {{
                                this.ocf }}{{/if}}</span></td>
                        {{!-- <td class="gestor-campo">Gestor:</td>
                        <td class="estado-campo">Estado: <span class="estado-valor">{{#if this.estadoOp}}{{
                                this.estadoOp }}{{/if}}</span></td> --}}
                    </tr>
                </table>

                <!-- Tabla de productos -->
                {{#if this.productos}}
                <table class="tabla-productos">
                    <thead>
                        <tr>
                            <th class="col-producto">PRODUCTO</th>
                            <th class="col-descripcion">DESCRIPCIÓN</th>
                            <th class="col-cantidad">CANTIDAD</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each this.productos}}
                        <tr>
                            <td class="producto-codigo">{{ this.codigo }}</td>
                            <td class="producto-descripcion">{{ this.descripcion }}</td>
                            <td class="producto-cantidad">{{ this.cantidad }}</td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
                {{/if}}

                <!-- Información del proveedor -->
                {{#if this.proveedor}}
                <table class="info-proveedor">
                    <tr>
                        <td class="label-proveedor">PROVEEDOR</td>
                        <td class="data-proveedor">{{ this.proveedor.empresa }}</td>
                    </tr>
                    {{#if this.proveedor.contacto}}
                    <tr>
                        <td class="label-ventas">CONTACTO:</td>
                        <td class="data-ventas">{{ this.proveedor.contacto }} {{#if this.proveedor.telefono}}TELÉFONO:
                            {{ this.proveedor.telefono }}{{/if}}</td>
                    </tr>
                    {{/if}}
                </table>
                {{/if}}

                <!-- Información del transporte asignado -->
                {{#if this.transporteAsignado}}
                <table class="info-transporte">
                    <tr>
                        <td class="label-transporte">TRANSPORTE ASIGNADO</td>
                        <td class="data-transporte">{{ this.transporteAsignado.razonSocial }}</td>
                    </tr>
                    {{#if this.transporteAsignado.ubicacion}}
                    <tr>
                        <td class="label-ubicacion-transporte">UBICACIÓN:</td>
                        <td class="data-ubicacion-transporte">{{ this.transporteAsignado.ubicacion }}</td>
                    </tr>
                    {{/if}}
                    {{#if this.transporteAsignado.contacto}}
                    <tr>
                        <td class="label-contacto-transporte">CONTACTO:</td>
                        <td class="data-contacto-transporte">{{ this.transporteAsignado.contacto.nombre }} - {{
                            this.transporteAsignado.contacto.rol }} - {{ this.transporteAsignado.contacto.telefono }}
                        </td>
                    </tr>
                    {{/if}}
                </table>
                {{/if}}

                <!-- Información del destino -->
                {{#if this.destino}}
                <table class="info-destino">
                    <tr>
                        <td class="label-destino">DESTINO {{#if this.destino.tipoDestino}}{{ this.destino.tipoDestino
                            }}{{/if}}</td>
                        <td class="data-destino"></td>
                    </tr>
                    {{#if this.destino.cliente}}
                    <tr>
                        <td class="label-cliente">Cliente</td>
                        <td class="data-cliente">{{ this.destino.cliente }}</td>
                    </tr>
                    {{/if}}
                    {{#if this.destino.direccion}}
                    <tr>
                        <td class="label-direccion">DESTINO:</td>
                        <td class="data-direccion">{{ this.destino.direccion }}</td>
                    </tr>
                    {{/if}}
                    {{#if this.destino.ubicacion}}
                    <tr>
                        <td class="label-ubicacion"></td>
                        <td class="data-ubicacion">{{ this.destino.ubicacion }}</td>
                    </tr>
                    {{/if}}
                    {{#if this.destino.referencia}}
                    <tr>
                        <td class="label-referencia">REFERENCIA:</td>
                        <td class="data-referencia">{{ this.destino.referencia }}</td>
                    </tr>
                    {{/if}}
                    {{#if this.destino.contacto}}
                    <tr>
                        <td class="label-jefe">JEFE DE ALMACÉN:</td>
                        <td class="data-jefe">{{ this.destino.contacto }}</td>
                    </tr>
                    {{/if}}
                    {{#if this.destino.telefono}}
                    <tr>
                        <td class="label-telefono">TELÉFONO:</td>
                        <td class="data-telefono">{{ this.destino.telefono }}</td>
                    </tr>
                    {{/if}}
                    {{#if this.oc}}
                    <tr>
                        <td class="label-oc">OC:</td>
                        <td class="data-oc">{{ this.oc }}</td>
                    </tr>
                    {{/if}}
                    {{#if this.observacionesOp}}
                    <tr>
                        <td class="label-observaciones">OBSERVACIONES OP:</td>
                        <td class="data-observaciones">{{ this.observacionesOp }}</td>
                    </tr>
                    {{/if}}
                </table>
                {{/if}}

                <!-- Observaciones -->
                {{#if this.observacion}}
                <table class="info-observacion">
                    <tr>
                        <td class="label-observacion">OBSERVACIÓN</td>
                        <td class="data-observacion">{{ this.observacion }}</td>
                    </tr>
                </table>
                {{/if}}
            </div>
            {{/each}}
        </div>
        {{/each}}
        {{else}}
        <!-- Sin datos -->
        <div class="sin-datos">
            <h3>No se encontraron datos</h3>
            <p>No hay órdenes de proveedor para el período seleccionado</p>
        </div>
        {{/if}}
        <script>
            // Función para imprimir automáticamente cuando se carga la página
            window.onload = function () {
                // Pequeño delay para asegurar que el contenido se cargue completamente
                setTimeout(function () {
                    window.print();
                }, 500);
            };

            // Función para cerrar la ventana después de imprimir (opcional)
            window.onafterprint = function () {
                // Cerrar la ventana después de imprimir (solo si se abrió en popup)
                if (window.opener) {
                    window.close();
                }
            };
        </script>
</body>

</html>